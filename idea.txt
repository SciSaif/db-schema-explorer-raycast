# Project: Raycast DB-to-AI Schema Context

### **The Core Problem**

When prompting AI for database-related tasks, developers manually hunt for table definitions in tools like TablePlus or DBeaver. This context-gathering is slow, and "Copy as SQL" from GUI tools is often buried in menus or contains unnecessary bloat for LLMs.

### **The Solution**

A high-performance Raycast extension that acts as a **local, searchable dictionary** of your database schema(s), optimized specifically for feeding context to AI models. Users can add and manage **multiple databases**; each has its own cache, credentials, and exclusion rules.

---

### **Key Features**

- **Multiple Databases:** Add and manage several database connections. Each database has its own name, credentials, local schema cache, and exclusion rules. You can **set a default database** so Explore Tables opens directly to that database’s tables.
- **Instant Local Cache:** Instead of querying the database on every keystroke (which is slow), the extension stores the schema in a local **JSON file per database**. This makes searching for tables feel "zero-latency."
- **One-Command Sync (per database):** A "Sync Schema" flow connects to the selected database, fetches the latest metadata (tables, columns, types, relations, enums, indices), and updates that database’s local cache. Resync is also available from within **Manage Databases** when viewing a database.
- **Dual-Pane Interface (Explore Tables):**
    - **Left Side:** A searchable list of all tables and views (from the selected database’s cache). If a default database is set, tables for that DB are shown immediately when you run Explore Tables.
    - **Right Side:** A Markdown preview showing the exact `CREATE TABLE` DDL for the selected item. The **search bar accessory** (dropdown on the right of the search bar) lets you **switch the active database** without leaving the command.
- **AI-Optimized Output:** The copied SQL is formatted for token efficiency and includes helpful comments regarding foreign key relationships and custom Enums.
- **Fast Action:** Hitting `Enter` instantly copies the full DDL to the clipboard.
- **Exclusion Rules (per database):** Managed **inside Manage Databases** when you open a database (no separate Exclude Tables command). Rules control which tables stay hidden in Explore Tables for that database. Rules can be:
    - **Regex match** — exclude tables whose full name matches a regex (e.g. `^hdb_catalog\..*`).
    - **Contains** — exclude tables whose name contains a substring (e.g. `hdb_catalog`).
    - **Does not contain** — exclude tables that do *not* contain a substring (useful to show only a subset).  
  Rules are stored locally per database and applied when listing tables in Explore Tables for that database.

---

### **Commands**

| **Command** | **What it does** |
| --- | --- |
| **Manage Databases** | List all added databases. Option to **set default database** (used by Explore Tables when opening). Open a database to view/update credentials, resync schema, and manage exclusion rules. Add new databases here (dropdown for database type; **Postgres** default and only option for now). |
| **Sync Schema** | Pick a database (if multiple), then connect, fetch tables/views/columns/types/relations/enums/indices, build DDL, and write the schema to that database’s local JSON cache. |
| **Explore Tables** | Opens directly to the **default database’s** tables if one is set; otherwise prompts to pick a database. **Switch database** anytime via the **search bar accessory** (dropdown on the right). Searchable list of tables/views from the active database’s cache (grouped by schema); respects exclusion rules. Select a table to see DDL in the detail pane; Enter copies to clipboard. |

---

### **Manage Databases – Flow**

- **List view:** All added databases (name, type, last synced, default indicator). Actions: Add Database, Open (select one), **Set as default** (mark one database as default for Explore Tables).
- **Open a database:** Detail view for that database:
    - **Credentials** — view and update connection details (e.g. Postgres URL).
    - **Resync** — trigger schema sync for this database.
    - **Set as default** — make this database the one Explore Tables opens to (optional; can also be set from list view).
    - **Exclusion rules** — add, view, remove rules (regex, contains, does not contain) for this database.
- **Add Database:** User enters name and connection details; a **dropdown selects database type** (e.g. Postgres, MySQL, MongoDB). **Postgres is the default and the only option for now**; the dropdown is in place for future DB types.

---

### **Technical Architecture**

| **Layer** | **Implementation** |
| --- | --- |
| **Data Source** | PostgreSQL (Information Schema & `pg_catalog`) per database. More types later. |
| **Storage Format** | **Structured JSON per database** (Key: Table Name; Value: SQL String + Metadata). Plus a registry of databases (ids, names, types, credentials refs, exclusion rules, **default database id**). |
| **Storage Location** | Raycast `supportPath` (Local filesystem). |
| **Frontend** | Raycast `List` and `Detail` components (React/TypeScript). |
| **Output Format** | Clean, standard SQL DDL (Standard `CREATE TABLE` syntax). |

---

### **Unique Selling Points (USP)**

1. **Speed:** Faster than opening a DB client; strictly focused on *retrieval*, not *management*.
2. **Context Precision:** Unlike general DB tools, this can be tweaked to include/exclude specific metadata (like dropping verbose `GRANT` statements) to save AI tokens.
3. **Local Privacy:** No schema data leaves your machine except for what you manually paste into your AI of choice.

---

### **Future Roadmap Ideas**

- **Multi-Select:** Select 3-4 tables at once and copy a combined "context block."
- **Format Toggling:** Switch between SQL DDL, Prisma Schema, or TypeScript Interfaces.
- **Diagram Support:** Use a library to generate Mermaid.js ERD strings for the selected tables.
- **More database types:** Add MySQL, MongoDB, etc. to the "database type" dropdown (UI is already in place; Postgres only for now).
